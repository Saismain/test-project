# Система сбора и анализа данных устройств

## Описание проекта
Система представляет собой веб-сервис для сбора, хранения и анализа данных с различных устройств. Сервис построен на базе FastAPI, PostgreSQL и Celery, что обеспечивает его высокую производительность и масштабируемость.

## Основные возможности
- Сбор и хранение данных с устройств
- Асинхронный анализ данных с использованием Celery
- REST API для взаимодействия с системой
- Анализ статистики по устройствам и пользователям
- Возможность получения агрегированных данных за указанный период

## Стек
- **FastAPI** 
- **PostgreSQL** 
- **Celery** 
- **Redis** 
- **SQLAlchemy** 
- **Docker** 


## Эндпоинты
- `POST /devices/` - Создание нового устройства
- `POST /devices/{device_id}/stats/` - Добавление статистики устройства
- `GET /devices/{device_id}/stats/` - Получение статистики устройства
для параметра start_time и end_time нужно указать время в формате timestamp, например:
2023-10-01T12:00:00 и 2026-10-01T12:00:00
- `POST /devices/{device_id}/analyze/` - Запуск анализа устройства
- `POST /users/{owner}/analyze/` - Запуск анализа всех устройств пользователя
- `GET /analysis/{task_id}/` - Получение результатов анализа
По полученному параметру возвращает среднее значени x, y, z и количество записей из БД.
task id получается для пользователя с помощью одного из двух пост запросов указанных выше.
- `GET /devices/{device_id}/analysis/` - Получение всех результатов анализа устройства
- `GET /devices/{device_id}/analytics/` - Получение аналитики устройства с фильтрацией по времени

## Установка и запуск
docker-compose up --build
затем зайти на http://localhost:8000/docs#/

## Тестирование с помошью locust
чтобы начать тестирование нужно перейти на адрес - http://localhost:8089/
тестирование работает по следующей логике:
создается новое устройство, для него добавляется 5 рандомных записей статистики, затем отдается 

## Проверка базы данных
чтобы зайти в базу данных с правми суперпользователя, необходимо ввести консольную команду:
docker exec -it project-db-1 psql -U postgres
